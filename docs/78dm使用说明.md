# 78动漫爬虫使用说明

## 📋 概述

这个爬虫专门用于从 [78动漫资料库](https://acg.78dm.net) 爬取高达模型数据。

## 🚀 快速开始

### 第一步：安装依赖

```bash
cd gunpla_price_tool
py -m pip install beautifulsoup4 requests lxml
```

### 第二步：运行爬虫

```bash
py 78dm_scraper.py
```

## 📝 使用方法

### 方法1：爬取RG系列（默认）

直接运行脚本，会自动爬取RG系列：

```bash
py 78dm_scraper.py
```

### 方法2：爬取其他级别

修改 `78dm_scraper.py` 文件，在 `if __name__ == '__main__':` 部分添加：

```python
# 爬取MG系列（需要找到MG系列的URL）
scrape_by_grade('MG', 'https://acg.78dm.net/ct/XXXXX.html')

# 爬取HG系列
scrape_by_grade('HG', 'https://acg.78dm.net/ct/XXXXX.html')
```

**如何找到其他级别的URL：**

1. 访问 https://acg.78dm.net
2. 在导航栏找到对应的级别（MG、HG等）
3. 点击进入该级别的系列页面
4. 复制浏览器地址栏的URL

### 方法3：在Python中调用

```python
from 78dm_scraper import scrape_by_grade, scrape_rg_series

# 爬取RG系列
scrape_rg_series()

# 爬取其他级别
scrape_by_grade('MG', 'https://acg.78dm.net/ct/XXXXX.html')
```

## 🎯 爬取的内容

当前爬虫会提取：

- ✅ **名称**（中文名称）
- ✅ **级别**（RG、MG、HG等）
- ✅ **机体编号**（自动从名称中提取，如RX-78-2、MS-06S等）
- ⏳ **价格**（需要访问每个单品页面，速度较慢）

## ⚠️ 注意事项

### 1. 价格信息

由于价格信息在单品详情页面，爬取所有价格需要访问每个单品页面，这会：
- 速度较慢（每个页面需要1-2秒）
- 可能触发网站的反爬虫机制

**建议：**
- 先只爬取名称和基本信息
- 价格信息可以后续手动补充，或单独运行价格爬取

### 2. 网络请求

- 脚本已设置请求延迟，避免请求过快
- 如果遇到429错误（请求过多），可以增加延迟时间

### 3. 数据去重

- 脚本会自动去重，相同的模型不会重复添加
- 如果模型已存在，会跳过

### 4. 数据更新

- 如果模型已存在但价格为空，会尝试更新价格
- 已存在的完整数据不会被覆盖

## 🔧 高级用法

### 爬取详细信息（包括价格）

如果需要爬取价格等详细信息，可以修改 `scrape_series_page` 函数，在获取列表后调用 `scrape_item_detail`：

```python
# 在 scrape_series_page 函数中
for item in gunpla_list:
    detail = scraper.scrape_item_detail(item['url'])
    item.update(detail)
    time.sleep(1)  # 延迟1秒，避免请求过快
```

**注意：** 这会大大增加爬取时间，建议分批进行。

### 批量爬取多个级别

```python
# 定义各个级别的URL
series_urls = {
    'RG': 'https://acg.78dm.net/ct/341672.html',
    'MG': 'https://acg.78dm.net/ct/XXXXX.html',  # 需要找到实际URL
    'HG': 'https://acg.78dm.net/ct/XXXXX.html',  # 需要找到实际URL
}

for grade, url in series_urls.items():
    scrape_by_grade(grade, url)
    time.sleep(2)  # 每个级别之间延迟2秒
```

## 📊 爬取结果

运行完成后，您会看到：

```
正在爬取: https://acg.78dm.net/ct/341672.html
级别: RG
找到 43 个模型

保存完成！
新增: 43 条
更新: 0 条
跳过（已存在）: 0 条
```

## 🐛 问题排查

### 问题1：爬取不到数据

**可能原因：**
- 网站结构发生变化
- 网络连接问题
- 网站需要登录

**解决方法：**
- 检查网络连接
- 手动访问URL，确认页面可以正常打开
- 查看终端错误信息

### 问题2：数据不完整

**可能原因：**
- 网站使用JavaScript动态加载内容
- 需要登录才能看到完整数据

**解决方法：**
- 可能需要使用Selenium等工具处理JavaScript
- 或者手动补充缺失的数据

### 问题3：价格信息缺失

**原因：**
- 价格在单品详情页面，需要单独爬取

**解决方法：**
- 先爬取基本信息
- 价格可以后续手动补充或单独爬取

## 💡 提示

1. **先测试少量数据**
   - 可以先修改代码，只爬取前5-10个模型测试

2. **分批爬取**
   - 如果数据量大，可以分批爬取，避免一次性请求过多

3. **定期更新**
   - 可以定期运行爬虫，更新新发布的模型

4. **手动补充**
   - 价格等详细信息可以手动在网页应用中补充

## 📞 需要帮助？

如果遇到问题，请提供：
1. 终端错误信息
2. 目标URL
3. 期望爬取的数据

我可以帮您调整爬虫脚本！
