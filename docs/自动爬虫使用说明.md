# 自动爬虫使用说明

## 🎯 功能说明

这个自动爬虫可以从78动漫主页开始，自动：
1. 找到"资料库"链接
2. 识别所有高达级别（PG、MG、RG、HG等）
3. 对每个级别分别进行爬取
4. 自动识别子分类
5. 爬取价格信息（可选）

## 🚀 使用方法

### 方法1：爬取所有找到的级别

```bash
cd gunpla_price_tool
py 78dm_auto_scraper.py
```

然后修改脚本，取消注释：
```python
# 爬取所有找到的级别
scraper.scrape_all_grades(include_price=True, delay=1.5)
```

### 方法2：只爬取指定的级别（推荐）

修改 `78dm_auto_scraper.py` 文件，在 `if __name__ == '__main__':` 部分：

```python
# 爬取RG级别
scrape_specific_grades(['RG'], include_price=True)

# 爬取多个级别
scrape_specific_grades(['RG', 'MG', 'HG'], include_price=True)
```

## 📝 爬取流程

1. **自动查找级别链接**
   - 访问资料库页面
   - 查找所有级别的链接
   - 显示找到的级别

2. **逐个爬取每个级别**
   - 爬取模型列表
   - 识别子分类
   - 爬取价格信息（如果启用）
   - 保存到数据库

3. **显示统计信息**
   - 每个级别的模型数量
   - 子分类统计
   - 保存结果

## ⚙️ 参数说明

### `scrape_all_grades()` 参数

- `grades_to_scrape`: 要爬取的级别列表，如 `['RG', 'MG']`，如果为`None`则爬取所有
- `include_price`: 是否爬取价格信息（默认`True`）
- `delay`: 每个请求之间的延迟，秒（默认1.5秒）

### `scrape_specific_grades()` 参数

- `grades`: 级别列表，如 `['RG', 'MG', 'HG']`
- `include_price`: 是否爬取价格信息（默认`True`）

## 💡 推荐使用方式

### 第一次使用：测试单个级别

```python
# 只爬取RG级别，测试功能
scrape_specific_grades(['RG'], include_price=True)
```

### 确认无误后：爬取多个级别

```python
# 爬取主要级别
scrape_specific_grades(['RG', 'MG', 'HG'], include_price=True)
```

### 批量爬取：所有级别

```python
# 爬取所有找到的级别（需要较长时间）
scraper.scrape_all_grades(include_price=True, delay=1.5)
```

## ⏱️ 预计时间

- **单个级别（RG，219个模型）**：约 5-6 分钟（包含价格）
- **多个级别**：按级别数量累加
- **所有级别**：可能需要数小时

## ⚠️ 注意事项

1. **网络连接**：确保网络稳定
2. **请求频率**：已设置延迟，避免请求过快
3. **数据量**：所有级别数据量很大，建议分批爬取
4. **数据库**：确保数据库有足够空间

## 🔧 故障排除

### 问题1：找不到级别链接

**原因**：网站结构可能发生变化

**解决**：
- 检查网络连接
- 手动访问 https://acg.78dm.net 确认可以访问
- 可以手动指定级别URL（见下面的方法）

### 问题2：某些级别爬取失败

**原因**：该级别的URL可能不正确

**解决**：
- 手动查找该级别的URL
- 使用 `scrape_by_grade()` 函数单独爬取

### 问题3：价格爬取失败

**原因**：单品页面结构可能不同

**解决**：
- 可以先不爬取价格：`include_price=False`
- 后续手动补充价格信息

## 📊 示例输出

```
============================================================
正在查找所有级别的链接...
============================================================
访问资料库: https://acg.78dm.net
找到 RG 级别: https://acg.78dm.net/ct/341672.html
找到 MG 级别: https://acg.78dm.net/ct/XXXXX.html

找到 2 个级别:
  RG: https://acg.78dm.net/ct/341672.html
  MG: https://acg.78dm.net/ct/XXXXX.html

============================================================
[1/2] 开始爬取 RG 级别
============================================================
正在爬取: https://acg.78dm.net/ct/341672.html
级别: RG

子分类统计：
  普通版: 43 个
  网络限定版: 78 个
  ...

找到 219 个模型
...
```

## 🎯 下一步

爬取完成后，在网页应用中：
1. 查看所有级别的数据
2. 按级别筛选
3. 按子分类筛选
4. 查看价格信息
