# çˆ¬è™«ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

è¿™ä¸ªçˆ¬è™«è„šæœ¬å¯ä»¥å¸®åŠ©æ‚¨ä»ç½‘ç«™ä¸Šè‡ªåŠ¨çˆ¬å–é«˜è¾¾æ•°æ®å¹¶å¯¼å…¥åˆ°æ•°æ®åº“ä¸­ã€‚

## ğŸ”§ å®‰è£…ä¾èµ–

é¦–å…ˆéœ€è¦å®‰è£…çˆ¬è™«æ‰€éœ€çš„åº“ï¼š

```bash
py -m pip install beautifulsoup4 requests lxml
```

## ğŸ“ ä½¿ç”¨æ­¥éª¤

### æ­¥éª¤1ï¼šåˆ†æç›®æ ‡ç½‘ç«™ç»“æ„

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦ï¼š

1. **æ‰“å¼€ç›®æ ‡ç½‘ç«™**
2. **å³é”®ç‚¹å‡»é¡µé¢ï¼Œé€‰æ‹©"æ£€æŸ¥"æˆ–"å®¡æŸ¥å…ƒç´ "**
3. **æŸ¥çœ‹ç½‘é¡µçš„HTMLç»“æ„**ï¼Œæ‰¾åˆ°ï¼š
   - æ•°æ®åœ¨å“ªä¸ªHTMLå…ƒç´ ä¸­ï¼ˆtableã€divç­‰ï¼‰
   - åç§°ã€ä»·æ ¼ã€çº§åˆ«ç­‰ä¿¡æ¯çš„classæˆ–æ ‡ç­¾
   - æ˜¯å¦æœ‰åˆ†é¡µ

### æ­¥éª¤2ï¼šä¿®æ”¹çˆ¬è™«è„šæœ¬

æ‰“å¼€ `scraper.py`ï¼Œæ ¹æ®å®é™…ç½‘ç«™ç»“æ„è°ƒæ•´ä»¥ä¸‹å‡½æ•°ï¼š

#### 2.1 ä¿®æ”¹ `parse_table_row()` å‡½æ•°

å¦‚æœæ•°æ®åœ¨è¡¨æ ¼ä¸­ï¼Œä¿®æ”¹è¿™ä¸ªå‡½æ•°ï¼š

```python
def parse_table_row(self, cells):
    """è§£æè¡¨æ ¼è¡Œæ•°æ®"""
    data = {}
    
    # æ ¹æ®å®é™…è¡¨æ ¼ç»“æ„è°ƒæ•´
    # ä¾‹å¦‚ï¼šç¬¬0åˆ—æ˜¯åç§°ï¼Œç¬¬1åˆ—æ˜¯çº§åˆ«ï¼Œç¬¬2åˆ—æ˜¯ä»·æ ¼
    if len(cells) > 0:
        data['name_cn'] = cells[0].get_text(strip=True)
    
    if len(cells) > 1:
        grade_text = cells[1].get_text(strip=True)
        data['grade'] = self.parse_grade_from_text(grade_text)
    
    if len(cells) > 2:
        price_text = cells[2].get_text(strip=True)
        data['price_jp_msrp'] = self.parse_price(price_text)
    
    # æ·»åŠ æ›´å¤šå­—æ®µ...
    
    return data if data.get('name_cn') else None
```

#### 2.2 ä¿®æ”¹ `parse_item_div()` å‡½æ•°

å¦‚æœæ•°æ®åœ¨divä¸­ï¼Œä¿®æ”¹è¿™ä¸ªå‡½æ•°ï¼š

```python
def parse_item_div(self, item):
    """è§£ædivå…ƒç´ ä¸­çš„æ•°æ®"""
    data = {}
    
    # æ ¹æ®å®é™…HTMLç»“æ„è°ƒæ•´
    # ä¾‹å¦‚ï¼šåç§°åœ¨ <h3> æ ‡ç­¾ä¸­
    name_elem = item.find('h3', class_='gunpla-name')
    if name_elem:
        data['name_cn'] = name_elem.get_text(strip=True)
    
    # ä»·æ ¼åœ¨ <span class="price"> ä¸­
    price_elem = item.find('span', class_='price')
    if price_elem:
        price_text = price_elem.get_text(strip=True)
        data['price_jp_msrp'] = self.parse_price(price_text)
    
    # æ·»åŠ æ›´å¤šå­—æ®µ...
    
    return data if data.get('name_cn') else None
```

#### 2.3 ä¿®æ”¹ `scrape_gunpla_from_url()` å‡½æ•°

æ ¹æ®å®é™…ç½‘ç«™ç»“æ„ï¼Œè°ƒæ•´å¦‚ä½•æŸ¥æ‰¾æ•°æ®ï¼š

```python
def scrape_gunpla_from_url(self, url):
    # å¦‚æœæ•°æ®åœ¨è¡¨æ ¼ä¸­
    tables = soup.find_all('table', class_='gunpla-table')  # æ ¹æ®å®é™…classè°ƒæ•´
    
    # å¦‚æœæ•°æ®åœ¨divä¸­
    items = soup.find_all('div', class_='gunpla-item')  # æ ¹æ®å®é™…classè°ƒæ•´
    
    # å¦‚æœæ•°æ®åœ¨åˆ—è¡¨ä¸­
    items = soup.find_all('li', class_='gunpla-list-item')  # æ ¹æ®å®é™…classè°ƒæ•´
```

### æ­¥éª¤3ï¼šé…ç½®URLå’Œçº§åˆ«

åœ¨ `scraper.py` çš„ `if __name__ == '__main__':` éƒ¨åˆ†ï¼Œæ·»åŠ å®é™…çš„URLï¼š

```python
if __name__ == '__main__':
    # çˆ¬å–RGçº§åˆ«
    scrape_by_grade('RG', [
        'https://example.com/rg-list',
        'https://example.com/rg-list?page=2',  # å¦‚æœæœ‰åˆ†é¡µ
    ])
    
    # çˆ¬å–MGçº§åˆ«
    scrape_by_grade('MG', [
        'https://example.com/mg-list',
    ])
    
    # çˆ¬å–HGçº§åˆ«
    scrape_by_grade('HG', [
        'https://example.com/hg-list',
    ])
```

### æ­¥éª¤4ï¼šè¿è¡Œçˆ¬è™«

```bash
cd gunpla_price_tool
py scraper.py
```

## ğŸ¯ å®é™…ç¤ºä¾‹

å‡è®¾æ‚¨çš„ç½‘ç«™ç»“æ„æ˜¯è¿™æ ·çš„ï¼š

```html
<table class="gunpla-list">
  <tr>
    <td>RX-78-2 é«˜è¾¾</td>
    <td>MG</td>
    <td>4500æ—¥å…ƒ</td>
    <td>RX-78-2</td>
  </tr>
  ...
</table>
```

é‚£ä¹ˆå¯ä»¥è¿™æ ·ä¿®æ”¹ `parse_table_row()`ï¼š

```python
def parse_table_row(self, cells):
    if len(cells) < 3:
        return None
    
    data = {
        'name_cn': cells[0].get_text(strip=True),
        'grade': cells[1].get_text(strip=True),
        'price_jp_msrp': self.parse_price(cells[2].get_text(strip=True)),
        'ms_number': cells[3].get_text(strip=True) if len(cells) > 3 else None,
    }
    
    return data if data['name_cn'] else None
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **éµå®ˆç½‘ç«™è§„åˆ™**
   - æŸ¥çœ‹ç½‘ç«™çš„robots.txt
   - ä¸è¦è¯·æ±‚è¿‡å¿«ï¼ˆè„šæœ¬ä¸­å·²è®¾ç½®1ç§’å»¶è¿Ÿï¼‰
   - å°Šé‡ç½‘ç«™çš„æœåŠ¡æ¡æ¬¾

2. **ç½‘ç«™ç»“æ„å˜åŒ–**
   - å¦‚æœç½‘ç«™æ”¹ç‰ˆï¼Œéœ€è¦é‡æ–°è°ƒæ•´è§£æå‡½æ•°
   - å»ºè®®å…ˆæµ‹è¯•å°‘é‡æ•°æ®

3. **æ•°æ®éªŒè¯**
   - çˆ¬å–åæ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®
   - å¯ä»¥åœ¨ç½‘é¡µåº”ç”¨ä¸­æŸ¥çœ‹å¯¼å…¥çš„æ•°æ®

4. **é”™è¯¯å¤„ç†**
   - å¦‚æœæŸä¸ªURLå¤±è´¥ï¼Œä¼šè·³è¿‡ç»§ç»­å¤„ç†å…¶ä»–URL
   - å·²å­˜åœ¨çš„æ•°æ®ä¼šè‡ªåŠ¨è·³è¿‡ï¼Œä¸ä¼šé‡å¤æ·»åŠ 

## ğŸ” è°ƒè¯•æŠ€å·§

1. **å…ˆæµ‹è¯•å•ä¸ªURL**
   ```python
   scraper = GunplaScraper()
   data = scraper.scrape_gunpla_from_url('https://example.com/rg-list')
   print(data)  # æŸ¥çœ‹çˆ¬å–çš„æ•°æ®
   ```

2. **æŸ¥çœ‹HTMLç»“æ„**
   - åœ¨æµè§ˆå™¨ä¸­å³é”®"æ£€æŸ¥å…ƒç´ "
   - æ‰¾åˆ°æ•°æ®æ‰€åœ¨çš„HTMLæ ‡ç­¾å’Œclass

3. **é€æ­¥æµ‹è¯•**
   - å…ˆçˆ¬å–ä¸€ä¸ªçº§åˆ«
   - ç¡®è®¤æ•°æ®æ­£ç¡®åå†çˆ¬å–å…¶ä»–çº§åˆ«

## ğŸ’¡ æç¤º

- å¦‚æœç½‘ç«™éœ€è¦ç™»å½•ï¼Œéœ€è¦åœ¨ `__init__` ä¸­æ·»åŠ cookie
- å¦‚æœç½‘ç«™æœ‰åçˆ¬è™«æœºåˆ¶ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä»£ç†æˆ–æ›´å¤æ‚çš„å¤„ç†
- å»ºè®®å…ˆæ‰‹åŠ¨æµ‹è¯•å‡ ä¸ªURLï¼Œç¡®è®¤å¯ä»¥è®¿é—®åå†æ‰¹é‡çˆ¬å–

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœæ‚¨èƒ½æä¾›ï¼š
1. ç›®æ ‡ç½‘ç«™çš„URLï¼ˆæˆ–ç¤ºä¾‹é¡µé¢ï¼‰
2. ç½‘é¡µçš„HTMLç»“æ„ï¼ˆå¯ä»¥æˆªå›¾æˆ–å¤åˆ¶HTMLï¼‰

æˆ‘å¯ä»¥å¸®æ‚¨è°ƒæ•´çˆ¬è™«è„šæœ¬ï¼Œä½¿å…¶é€‚é…æ‚¨çš„ç›®æ ‡ç½‘ç«™ï¼
